var vn=Object.defineProperty;var _n=(t,e,n)=>e in t?vn(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var st=(t,e,n)=>_n(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function n(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=n(s);fetch(s.href,l)}})();function Z(){}const ot=t=>t;function rn(t){return t()}function Mt(){return Object.create(null)}function me(t){t.forEach(rn)}function Be(t){return typeof t=="function"}function Ae(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Mn(t){return Object.keys(t).length===0}function an(t,...e){if(t==null){for(const o of e)o(void 0);return Z}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function se(t){let e;return an(t,n=>e=n)(),e}function ge(t,e,n){t.$$.on_destroy.push(an(e,n))}function wt(t){const e=typeof t=="string"&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}const cn=typeof window<"u";let ht=cn?()=>window.performance.now():()=>Date.now(),pt=cn?t=>requestAnimationFrame(t):Z;const ze=new Set;function fn(t){ze.forEach(e=>{e.c(t)||(ze.delete(e),e.f())}),ze.size!==0&&pt(fn)}function yt(t){let e;return ze.size===0&&pt(fn),{promise:new Promise(n=>{ze.add(e={c:t,f:n})}),abort(){ze.delete(e)}}}function f(t,e){t.appendChild(e)}function un(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function wn(t){const e=m("style");return e.textContent="/* empty */",bn(un(t),e),e.sheet}function bn(t,e){return f(t.head||t,e),e.sheet}function H(t,e,n){t.insertBefore(e,n||null)}function G(t){t.parentNode&&t.parentNode.removeChild(t)}function Ie(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function m(t){return document.createElement(t)}function U(t){return document.createTextNode(t)}function x(){return U(" ")}function mt(){return U("")}function re(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function dn(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function v(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function kn(t){return Array.from(t.childNodes)}function ne(t,e){e=""+e,t.data!==e&&(t.data=e)}function Ze(t,e){t.value=e??""}function pe(t,e,n,o){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}function ye(t,e,n){t.classList.toggle(e,!!n)}function hn(t,e,{bubbles:n=!1,cancelable:o=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:o})}const Je=new Map;let Ve=0;function In(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function $n(t,e){const n={stylesheet:wn(e),rules:{}};return Je.set(t,n),n}function Xe(t,e,n,o,s,l,r,i=0){const c=16.666/o;let a=`{
`;for(let A=0;A<=1;A+=c){const R=e+(n-e)*l(A);a+=A*100+`%{${r(R,1-R)}}
`}const u=a+`100% {${r(n,1-n)}}
}`,p=`__svelte_${In(u)}_${i}`,y=un(t),{stylesheet:b,rules:d}=Je.get(y)||$n(y,t);d[p]||(d[p]=!0,b.insertRule(`@keyframes ${p} ${u}`,b.cssRules.length));const $=t.style.animation||"";return t.style.animation=`${$?`${$}, `:""}${p} ${o}ms linear ${s}ms 1 both`,Ve+=1,p}function Qe(t,e){const n=(t.style.animation||"").split(", "),o=n.filter(e?l=>l.indexOf(e)<0:l=>l.indexOf("__svelte")===-1),s=n.length-o.length;s&&(t.style.animation=o.join(", "),Ve-=s,Ve||An())}function An(){pt(()=>{Ve||(Je.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&G(e)}),Je.clear())})}let Fe;function Ue(t){Fe=t}function gt(){if(!Fe)throw new Error("Function called outside component initialization");return Fe}function Cn(t){gt().$$.on_mount.push(t)}function Sn(t){gt().$$.on_destroy.push(t)}function Tn(){const t=gt();return(e,n,{cancelable:o=!1}={})=>{const s=t.$$.callbacks[e];if(s){const l=hn(e,n,{cancelable:o});return s.slice().forEach(r=>{r.call(t,l)}),!l.defaultPrevented}return!0}}function pn(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(o=>o.call(this,e))}const xe=[],rt=[];let Oe=[];const bt=[],En=Promise.resolve();let at=!1;function Dn(){at||(at=!0,En.then(yn))}function $e(t){Oe.push(t)}const lt=new Set;let je=0;function yn(){if(je!==0)return;const t=Fe;do{try{for(;je<xe.length;){const e=xe[je];je++,Ue(e),Rn(e.$$)}}catch(e){throw xe.length=0,je=0,e}for(Ue(null),xe.length=0,je=0;rt.length;)rt.pop()();for(let e=0;e<Oe.length;e+=1){const n=Oe[e];lt.has(n)||(lt.add(n),n())}Oe.length=0}while(xe.length);for(;bt.length;)bt.pop()();at=!1,lt.clear(),Ue(t)}function Rn(t){if(t.fragment!==null){t.update(),me(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach($e)}}function jn(t){const e=[],n=[];Oe.forEach(o=>t.indexOf(o)===-1?e.push(o):n.push(o)),n.forEach(o=>o()),Oe=e}let We;function vt(){return We||(We=Promise.resolve(),We.then(()=>{We=null})),We}function Ee(t,e,n){t.dispatchEvent(hn(`${e?"intro":"outro"}${n}`))}const Ke=new Set;let Me;function Pe(){Me={r:0,c:[],p:Me}}function qe(){Me.r||me(Me.c),Me=Me.p}function oe(t,e){t&&t.i&&(Ke.delete(t),t.i(e))}function fe(t,e,n,o){if(t&&t.o){if(Ke.has(t))return;Ke.add(t),Me.c.push(()=>{Ke.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}else o&&o()}const _t={duration:0};function Ln(t,e,n){const o={direction:"in"};let s=e(t,n,o),l=!1,r,i,c=0;function a(){r&&Qe(t,r)}function u(){const{delay:y=0,duration:b=300,easing:d=ot,tick:$=Z,css:A}=s||_t;A&&(r=Xe(t,0,1,b,y,d,A,c++)),$(0,1);const R=ht()+y,g=R+b;i&&i.abort(),l=!0,$e(()=>Ee(t,!0,"start")),i=yt(L=>{if(l){if(L>=g)return $(1,0),Ee(t,!0,"end"),a(),l=!1;if(L>=R){const _=d((L-R)/b);$(_,1-_)}}return l})}let p=!1;return{start(){p||(p=!0,Qe(t),Be(s)?(s=s(o),vt().then(u)):u())},invalidate(){p=!1},end(){l&&(a(),l=!1)}}}function xn(t,e,n){const o={direction:"out"};let s=e(t,n,o),l=!0,r;const i=Me;i.r+=1;let c;function a(){const{delay:u=0,duration:p=300,easing:y=ot,tick:b=Z,css:d}=s||_t;d&&(r=Xe(t,1,0,p,u,y,d));const $=ht()+u,A=$+p;$e(()=>Ee(t,!1,"start")),"inert"in t&&(c=t.inert,t.inert=!0),yt(R=>{if(l){if(R>=A)return b(0,1),Ee(t,!1,"end"),--i.r||me(i.c),!1;if(R>=$){const g=y((R-$)/p);b(1-g,g)}}return l})}return Be(s)?vt().then(()=>{s=s(o),a()}):a(),{end(u){u&&"inert"in t&&(t.inert=c),u&&s.tick&&s.tick(1,0),l&&(r&&Qe(t,r),l=!1)}}}function kt(t,e,n,o){let l=e(t,n,{direction:"both"}),r=o?0:1,i=null,c=null,a=null,u;function p(){a&&Qe(t,a)}function y(d,$){const A=d.b-r;return $*=Math.abs(A),{a:r,b:d.b,d:A,duration:$,start:d.start,end:d.start+$,group:d.group}}function b(d){const{delay:$=0,duration:A=300,easing:R=ot,tick:g=Z,css:L}=l||_t,_={start:ht()+$,b:d};d||(_.group=Me,Me.r+=1),"inert"in t&&(d?u!==void 0&&(t.inert=u):(u=t.inert,t.inert=!0)),i||c?c=_:(L&&(p(),a=Xe(t,r,d,A,$,R,L)),d&&g(0,1),i=y(_,A),$e(()=>Ee(t,d,"start")),yt(F=>{if(c&&F>c.start&&(i=y(c,A),c=null,Ee(t,i.b,"start"),L&&(p(),a=Xe(t,r,i.b,i.duration,0,R,l.css))),i){if(F>=i.end)g(r=i.b,1-r),Ee(t,i.b,"end"),c||(i.b?p():--i.group.r||me(i.group.c)),i=null;else if(F>=i.start){const P=F-i.start;r=i.a+i.d*R(P/i.duration),g(r,1-r)}}return!!(i||c)}))}return{run(d){Be(l)?vt().then(()=>{l=l({direction:d?"in":"out"}),b(d)}):b(d)},end(){p(),i=c=null}}}function ce(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Nn(t,e){fe(t,1,1,()=>{e.delete(t.key)})}function zn(t,e,n,o,s,l,r,i,c,a,u,p){let y=t.length,b=l.length,d=y;const $={};for(;d--;)$[t[d].key]=d;const A=[],R=new Map,g=new Map,L=[];for(d=b;d--;){const C=p(s,l,d),h=n(C);let S=r.get(h);S?L.push(()=>S.p(C,e)):(S=a(h,C),S.c()),R.set(h,A[d]=S),h in $&&g.set(h,Math.abs(d-$[h]))}const _=new Set,F=new Set;function P(C){oe(C,1),C.m(i,u),r.set(C.key,C),u=C.first,b--}for(;y&&b;){const C=A[b-1],h=t[y-1],S=C.key,N=h.key;C===h?(u=C.first,y--,b--):R.has(N)?!r.has(S)||_.has(S)?P(C):F.has(N)?y--:g.get(S)>g.get(N)?(F.add(S),P(C)):(_.add(N),y--):(c(h,r),y--)}for(;y--;){const C=t[y];R.has(C.key)||c(C,r)}for(;b;)P(A[b-1]);return me(L),A}function Ne(t){t&&t.c()}function Ce(t,e,n){const{fragment:o,after_update:s}=t.$$;o&&o.m(e,n),$e(()=>{const l=t.$$.on_mount.map(rn).filter(Be);t.$$.on_destroy?t.$$.on_destroy.push(...l):me(l),t.$$.on_mount=[]}),s.forEach($e)}function Se(t,e){const n=t.$$;n.fragment!==null&&(jn(n.after_update),me(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function On(t,e){t.$$.dirty[0]===-1&&(xe.push(t),Dn(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function De(t,e,n,o,s,l,r=null,i=[-1]){const c=Fe;Ue(t);const a=t.$$={fragment:null,ctx:[],props:l,update:Z,not_equal:s,bound:Mt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:Mt(),dirty:i,skip_bound:!1,root:e.target||c.$$.root};r&&r(a.root);let u=!1;if(a.ctx=n?n(t,e.props||{},(p,y,...b)=>{const d=b.length?b[0]:y;return a.ctx&&s(a.ctx[p],a.ctx[p]=d)&&(!a.skip_bound&&a.bound[p]&&a.bound[p](d),u&&On(t,p)),y}):[],a.update(),u=!0,me(a.before_update),a.fragment=o?o(a.ctx):!1,e.target){if(e.hydrate){const p=kn(e.target);a.fragment&&a.fragment.l(p),p.forEach(G)}else a.fragment&&a.fragment.c();e.intro&&oe(t.$$.fragment),Ce(t,e.target,e.anchor),yn()}Ue(c)}class Re{constructor(){st(this,"$$");st(this,"$$set")}$destroy(){Se(this,1),this.$destroy=Z}$on(e,n){if(!Be(n))return Z;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const s=o.indexOf(n);s!==-1&&o.splice(s,1)}}$set(e){this.$$set&&!Mn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Pn="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Pn);const Le=[];function be(t,e=Z){let n;const o=new Set;function s(i){if(Ae(t,i)&&(t=i,n)){const c=!Le.length;for(const a of o)a[1](),Le.push(a,t);if(c){for(let a=0;a<Le.length;a+=2)Le[a][0](Le[a+1]);Le.length=0}}}function l(i){s(i(t))}function r(i,c=Z){const a=[i,c];return o.add(a),o.size===1&&(n=e(s,l)||Z),i(t),()=>{o.delete(a),o.size===0&&n&&(n(),n=null)}}return{set:s,update:l,subscribe:r}}const K=20,z={EMPTY:"empty",RESIDENTIAL:"residential",COMMERCIAL:"commercial",INDUSTRIAL:"industrial",ROAD:"road",PARK:"park"},et={[z.RESIDENTIAL]:100,[z.COMMERCIAL]:200,[z.INDUSTRIAL]:300,[z.ROAD]:10,[z.PARK]:50,[z.EMPTY]:5},qn=Array(K).fill(null).map(()=>Array(K).fill(null).map(()=>({type:z.EMPTY,population:0,level:1,hasPower:!0,hasWater:!0}))),Te=be(qn),tt=be(5e3),He=be(0),_e=be(0),ct=be(null),mn=be({residential:50,commercial:0,industrial:0}),ve=be([]),nt=be([]),gn=be([{id:1,author:{name:"Mayor",isSystem:!0},text:"Welcome to SimTwitty! Start building zones to attract denizens.",time:0}]),it=["I'm trapped! No road out of here.","How do I get to work? The road is gone!","I can't get any deliveries. Moving out!","Is this an island? Where did the road go?","My car is useless without a street."],Wn=["The commute is killing me. Moving closer to work.","Spending 4 hours in traffic? No thanks. I'm out.","I miss my family. I spend all my time driving.","Gas prices are too high for this drive.","I need a job closer to home."],It=["The commute to {dest} is just too far from here!","I can't believe I have to drive all the way to {dest} every day.","Why is {dest} so far away? My car is crying.","Traffic to {dest} is a nightmare. I'm moving.","I love working at {dest}, but the drive is ruinous."],$t=["Just moved in near {dest}. Convenient!","Love being so close to {dest}.","Great location! {dest} is just a short walk away.","Finally, a short commute to {dest}.","This spot is perfect. I can see {dest} from my window."],Gn=["The smog is unbearable. I can't breathe!","Moving to the countryside. This air is toxic.","My laundry turns grey when I hang it outside.","Coughing all day. I'm leaving this smog city.","It smells like burning tires here. Bye!"],Un=["This neighborhood isn't what it used to be.","Time to move on.","Found a better place in another city.","Property values are tanking. Selling now!","Just don't like the vibe here anymore."],At=["optimist","pessimist","pragmatist","activist","cynic"];function Ct(){return At[Math.floor(Math.random()*At.length)]}const St={optimist:{supportive:["@Mayor I knew you'd come through! You're amazing!","@Mayor this is exactly what we needed. Thank you!","@Mayor I have faith in you, Mayor. Let's make this city great!","@Mayor seeing progress like this makes me smile. Keep it up!","@Mayor another win for our city! You're on a roll!"],dismissive:["@Mayor I'm sure you're doing your best. We'll figure it out!","@Mayor no worries, I'm confident things will improve.","@Mayor I still believe in you, Mayor!","@Mayor Rome wasn't built in a day. We can wait.","@Mayor hiccups happen. We'll bounce back!"],actionTaken:["@Mayor YES! This is incredible! I'm so happy right now!","@Mayor you actually did it! I knew you would!","@Mayor this changes everything! Thank you so much!","@Mayor proof that dreams come true! Best Mayor ever!","@Mayor I'm telling everyone I know about this!"],ignored:["@Mayor I'm sure you're busy. I can wait.","@Mayor no rush, Mayor. We're patient here.","@Mayor I still have hope things will get better.","@Mayor maybe next time! I'm staying positive.","@Mayor busy schedule, I get it. We're good."]},pessimist:{supportive:["@Mayor wow, you actually listened? I'm shocked.","@Mayor I guess that's something. Don't get my hopes up though.","@Mayor nice words. Let's see if you actually follow through.","@Mayor probably a fluke, but thanks anyway.","@Mayor I was ready to be disappointed, but... okay."],dismissive:["@Mayor figures. Just more empty promises.","@Mayor of course you don't care. Why would you?","@Mayor typical. I'm out of here.","@Mayor expected nothing and still disappointed.","@Mayor another day, another letdown from City Hall."],actionTaken:["@Mayor okay, I'll admit it. That actually helped.","@Mayor well, I didn't expect that. Maybe you're not so bad.","@Mayor fine, you did something right for once.","@Mayor don't think this fixes everything, but it's a start.","@Mayor I hate to say it, but good job."],ignored:["@Mayor I knew you wouldn't actually do anything.","@Mayor just as I expected. Useless.","@Mayor moving to a city with a competent mayor.","@Mayor why do I even bother asking?","@Mayor silence is loud. Message received."]},pragmatist:{supportive:["@Mayor good to see you're taking action. What's the timeline?","@Mayor solid response. How will this affect the budget?","@Mayor makes sense. Let's see the results.","@Mayor reasonable approach. Proceed.","@Mayor I appreciate the transparency."],dismissive:["@Mayor that doesn't address the core issue.","@Mayor nice sentiment, but what's the actual plan?","@Mayor words without action won't fix anything.","@Mayor efficient refusal, but a refusal nonetheless.","@Mayor that's not a solution, that's a deflection."],actionTaken:["@Mayor efficient. My commute is already 20% faster.","@Mayor the numbers don't lie. This actually works.","@Mayor finally, some practical solutions.","@Mayor property value up 2%. Acceptable.","@Mayor logical move. Glad you saw the data."],ignored:["@Mayor still waiting on concrete action.","@Mayor talk is cheap. Show me results.","@Mayor I'll move somewhere with real infrastructure.","@Mayor inefficiency at its finest.","@Mayor no response? Not very professional."]},activist:{supportive:["@Mayor YES! This is what real leadership looks like!","@Mayor I'm organizing a thank you rally. You in?","@Mayor this is the change we've been fighting for!","@Mayor the people's voice has been heard! Victory!","@Mayor solidarity! Thank you for standing with us!"],dismissive:["@Mayor that's not nearly enough. We demand more!","@Mayor half-measures won't cut it. We need real change!","@Mayor you're not listening to what we actually need.","@Mayor shameful! The citizens deserve better!","@Mayor we will not be silenced by your excuses!"],actionTaken:["@Mayor THIS is what we've been asking for! Keep it up!","@Mayor you're finally on the right side of history!","@Mayor the movement is working! Let's push for more!","@Mayor direct action gets results! Well done!","@Mayor power to the people! (And the Mayor, this time)."],ignored:["@Mayor we're not going away until you listen.","@Mayor the people demand action, not excuses!","@Mayor moving to a city that values its citizens.","@Mayor your silence speaks volumes about your priorities.","@Mayor ignore us at your peril. Election year is coming."]},cynic:{supportive:["@Mayor oh please, what's the catch?","@Mayor nice PR stunt. What are you really after?","@Mayor I'll believe it when I see it.","@Mayor who paid you to say that?","@Mayor sure, sure. And pigs fly."],dismissive:["@Mayor lol, you actually think that'll work?","@Mayor spare me the BS, Mayor.","@Mayor typical politician nonsense.","@Mayor yawn. Wake me up when you actually do something.","@Mayor is this a bot account? Feels like it."],actionTaken:["@Mayor okay, I'm mildly impressed. Don't let it go to your head.","@Mayor even a broken clock is right twice a day.","@Mayor fine, you did one thing right. Congrats.","@Mayor must be an election year if you're actually working.","@Mayor barely adequate. But I'll take it."],ignored:["@Mayor shocking. Absolutely shocking.","@Mayor I'm leaving before this city gets worse.","@Mayor you're a joke, and so is this city.","@Mayor exactly the incompetence I expected.","@Mayor 0/10 administration. Would not recommend."]}},Tt=["@Mayor we need a road at {home}!","@Mayor can you fix the pollution near {home}?","@Mayor my commute from {home} is brutal!","@Mayor why is {home} so isolated?","@Mayor {home} needs better infrastructure!","@Mayor this city needs more jobs!","@Mayor the pollution is unbearable!","@Mayor we need better infrastructure!","@Mayor traffic is out of control!","@Mayor we're overcrowded here!"],Et=["@{target} tell the Mayor to FOCUS! The city is burning (figuratively)!","@{target} is right, @Mayor stop distracted tweeting and build some roads!","@Mayor maybe less social media, more city planning? Listen to @{target}!","@Mayor your approval rating drops every time you tweet nonsense.","Seriously @Mayor? @{target} is waiting for a response and you tweet this?","@{target} remember that bridge to nowhere the Mayor built? Fix that first.","@Mayor I'm still waiting for water in Zone C, just saying. @{target} knows what's up.","@Mayor easy to tweet from your ivory tower while we sit in traffic. Right @{target}?","Yeah @{target}, the Mayor clearly doesn't care about our commute.","@Mayor we need more parks! #GreenCity cc: @{target}","Hey @{target}, tell the Mayor to build a stadium! Or at least a hot dog stand.","@Mayor forget roads, we need a monorail! #Monorail","Agreed with @{target}. More industrial zones! I love the smell of smog.","@{target} for Mayor! At least they reply."];function Hn(t,e){const n=t.toLowerCase(),o=e.home?e.home.toLowerCase():"",s=e.work?e.work.toLowerCase():"";return(n.includes(o)||n.includes(s))&&(n.includes("build")||n.includes("fix")||n.includes("improve")||n.includes("road"))||n.includes("build")||n.includes("fix")||n.includes("improve")?"actionTaken":n.includes("sorry")||n.includes("thanks")||n.includes("appreciate")||n.includes("listen")||n.includes("understand")||n.includes("working on")?"supportive":n.includes("no")||n.includes("can't")||n.includes("won't")||n.includes("impossible")||n.includes("not possible")?"dismissive":"ignored"}function Fn(t){return t.work&&!t.daysMissed&&t.unemployedDays===0?"happy":!t.work||t.unemployedDays>5?"desperate":t.daysMissed>3||t.unemployedDays>15?"angry":"neutral"}function Bn(t,e,n){const o=t.personality||"optimist",s=Fn(t);let l=St[o][n]||St[o].ignored;return s==="desperate"&&n==="ignored"&&(l=["@Mayor I'm leaving. This city doesn't care about us.","@Mayor I can't afford to stay here anymore.","@Mayor goodbye. I'm done waiting."]),s==="angry"&&n==="dismissive"&&(l=["@Mayor you just cost me my home. I hope you're happy.","@Mayor I trusted you. Never again.","@Mayor you've lost my vote forever."]),s==="happy"&&n==="supportive"&&(l=["@Mayor you're the best! This city is amazing!","@Mayor thanks for everything you do!","@Mayor I love living here!"]),l[Math.floor(Math.random()*l.length)]}function Yn(t){let e=Tt[Math.floor(Math.random()*Tt.length)];return e=e.replace("{home}",t.home||"here"),e}function Ge(){const t=["Urban","City","Metro","Town","Village","Street","Road","Lane","Park","Zone"],e=["Planner","Dweller","Sim","Citizen","Neighbor","Walker","Driver","Builder","Fan","Critic"];return t[Math.floor(Math.random()*t.length)]+e[Math.floor(Math.random()*e.length)]+Math.floor(Math.random()*1e3)}function Kn(t){const e=se(_e),n=se(ve);if(t){if(t.denizen)return t.denizen;if(t.x!=null&&t.y!=null){const c=n.find(a=>a.home===he(t.x,t.y));if(c)return c}}const o=n.filter(c=>!c.left);if(o.length>0)return o[Math.floor(Math.random()*o.length)];const s=Ge();let l="Homeless",r=null,i=e;return t&&t.type===z.RESIDENTIAL&&t.x!=null?l=he(t.x,t.y):l=he(Math.floor(Math.random()*K),Math.floor(Math.random()*K)),{name:s,home:l,work:r,since:i,history:[{type:"move_in",time:i,home:l}],isSystem:!1}}function ft(t,e,n){const o=ut(e,n);if(t===z.COMMERCIAL){const s=["Commerce Square","The Market","Shopping Center","Mall","Corner Store","Business Plaza","Trade Center","Retail Park"];return`${s[Math.floor(Math.random()*s.length)]} at ${o}`}else if(t===z.INDUSTRIAL){const s=["Industrial Park","Factory District","The Works","Manufacturing Hub","Tech Park","Warehouse Zone","Power Station","Refinery"];return`${s[Math.floor(Math.random()*s.length)]} at ${o}`}else if(t===z.RESIDENTIAL){const s=["The Apartments","Housing Block","Residences","Living Quarters","The Lofts","Condos","Villas","Estates"];return`${s[Math.floor(Math.random()*s.length)]} at ${o}`}else if(t===z.PARK){const s=["Green Park","City Garden","Recreation Area","The Commons","Nature Reserve","Playground","Central Park","Botanical Garden"];return`${s[Math.floor(Math.random()*s.length)]} at ${o}`}return`Zone at ${o}`}function Dt(t,e,n){let o=999,s=null;for(const l of n){const r=Math.sqrt(Math.pow(l.x-t,2)+Math.pow(l.y-e,2));r<o&&(o=r,s=l)}return s}function he(t,e){const n=String.fromCharCode(65+e),o=t+1;return`${n}${o}`}function ut(t,e){const n=String.fromCharCode(65+e),o=t+1,s=o%10,l=o%100;let r="th";return s==1&&l!=11&&(r="st"),s==2&&l!=12&&(r="nd"),s==3&&l!=13&&(r="rd"),`${n} St & ${o}${r}`}function we(t,e=null,n=null){gn.update(o=>{let s=e;return s?typeof s=="string"&&(s={name:s,isSystem:!0}):s=Kn(n),[{id:Date.now()+Math.random(),author:s,text:t,time:se(_e)},...o].slice(0,50)})}let Ye=[];function Zn(t){const n=se(ve).filter(l=>l.name!==t&&!l.left);if(n.length<3)return;const o=3+Math.floor(Math.random()*3),s=[];for(let l=0;l<o;l++)if(n.length>0){const r=Math.floor(Math.random()*n.length);s.push(n[r]),n.splice(r,1)}nt.update(l=>{const r=[...l],i=se(_e);return s.forEach((c,a)=>{let u=Et[Math.floor(Math.random()*Et.length)];u=u.replace("{target}",t),r.push({denizenName:c.name,playerTweet:"",forcedResponse:u,respondAt:i+2+a+Math.floor(Math.random()*2)})}),r})}function Jn(t,e){const n=se(_e);Ye.filter(s=>s.name===t&&n-s.time<60).length>=1&&Zn(t),Ye.push({name:t,time:n}),Ye=Ye.filter(s=>n-s.time<100),nt.update(s=>{const l=n+1+Math.floor(Math.random()*3);return[...s,{denizenName:t,playerTweet:e,respondAt:l}]})}function Vn(t){const e=t.match(/@(\w+)/);return e?e[1]:null}function Xn(){_e.update(C=>C+1);const t=se(_e),e=[],n=[],o=[],s=[],l=new Set,r=new Set,i=(C,h,S)=>{s.push({text:C,author:h,context:S})},c=se(Te);se(He);let a=0,u=0;c.forEach(C=>{C.forEach(h=>{h.type===z.RESIDENTIAL?a+=h.population:(h.type===z.COMMERCIAL||h.type===z.INDUSTRIAL)&&(u+=h.population)})});let p=50+(u-a),y=(a-u)*.5,b=(a-u)*.5;const d=C=>Math.max(-100,Math.min(100,C));p=d(p),y=d(y),b=d(b),mn.set({residential:p,commercial:y,industrial:b});const{roadNetworkMap:$,networks:A}=to(c),R=Qn(c),g=C=>{if(!C)return null;try{const h=C.match(/[A-Z]+/),S=C.match(/\d+/);if(!h||!S)return null;const N=h[0],k=parseInt(S[0]),Y=N.charCodeAt(0)-65;return{x:k-1,y:Y}}catch{return null}},L=u-a;let _=0;u>0&&L>0&&(_=Math.min(1,L/u*2)),Te.update(C=>{let h=0;const S=C.map(E=>E.map(T=>({...T,traffic:0}))),N=se(ve),k=Array(K).fill(null).map(()=>Array(K).fill(0)),Y=new Map;for(const E of N)if(E.home&&E.work&&!E.left){const T=g(E.home),w=g(E.work);if(T&&w){const J=C[T.y][T.x],O=C[w.y][w.x];if(!(J.type!==z.RESIDENTIAL||O.type!==z.COMMERCIAL&&O.type!==z.INDUSTRIAL)){const te=jt(T.x,T.y,C),W=jt(w.x,w.y,C);if(te.length>0&&W.length>0){const B=`${T.x},${T.y}-${w.x},${w.y}`;let M=Y.get(B);if(M||(M=eo(te,W,C),M&&Y.set(B,M)),M){for(const I of M)k[I.y][I.x]+=1;r.add(E.id)}else l.add(E.id)}else l.add(E.id)}}}new Set(N.filter(E=>E.lostJob).map(E=>E.id));for(let E=0;E<K;E++)for(let T=0;T<K;T++)S[E][T].type===z.ROAD&&(S[E][T].traffic=k[E][T]);for(let E=0;E<K;E++)for(let T=0;T<K;T++){const w=S[E][T];let J=null,O=!1;const te=[{dx:0,dy:-1},{dx:0,dy:1},{dx:-1,dy:0},{dx:1,dy:0}];for(const{dx:W,dy:B}of te){const M=T+W,I=E+B;if(M>=0&&M<K&&I>=0&&I<K&&C[I][M].type===z.ROAD&&(O=!0,J=$[I][M],J))break}if(w.type===z.RESIDENTIAL){const W=R[E][T];if(O&&J){const B=A.get(J);let M=999;B&&B.jobTiles.length>0&&(M=Rt(T,E,B.jobTiles));const j=M<=15;let q=p/100;if(W>5&&(q-=.5),W>20&&(q-=1),M<5?q+=.2:M>10&&(q-=.1),j&&q>0){if(w.population<50*w.level&&Math.random()<q&&(w.population+=1,e.push({x:T,y:E}),Math.random()<.05&&j&&B&&B.jobTiles.length>0)){const D=Dt(T,E,B.jobTiles);if(D){const Q=c[D.y][D.x],V=ft(Q.type,D.x,D.y),ee=$t[Math.floor(Math.random()*$t.length)],X={x:T,y:E,type:w.type,jobX:D.x,jobY:D.y,isGrowth:!0};i(ee.replace("{dest}",V),null,X)}}}else if(w.population>0&&(!j||W>20||q<-.2)&&(w.population-=1,n.push({x:T,y:E}),Math.random()<.1)){let D=Un,Q=null,V=null;if(!O)D=it;else if(W>20)D=Gn;else if(!j){if(B&&B.jobTiles.length>0){const X=Dt(T,E,B.jobTiles);if(X){const le=c[X.y][X.x],ue=ft(le.type,X.x,X.y);Q=It[Math.floor(Math.random()*It.length)].replace("{dest}",ue),V={jobX:X.x,jobY:X.y}}}Q||(D=Wn)}const ee={x:T,y:E,type:w.type,isLeaving:!0,...V};i(Q||D[Math.floor(Math.random()*D.length)],null,ee)}}else if(w.population>0&&(w.population-=1,n.push({x:T,y:E}),Math.random()<.1)){const B={x:T,y:E,type:w.type,isLeaving:!0};i(it[Math.floor(Math.random()*it.length)],null,B)}h+=w.population}else if(w.type===z.COMMERCIAL)if(O&&J){const W=A.get(J);let B=999;W&&W.resTiles.length>0&&(B=Rt(T,E,W.resTiles)),B<=20&&y>0?w.population<25*w.level&&Math.random()<y/100&&(w.population+=1,o.push({x:T,y:E,type:w.type})):w.population>0?(B>20?(w.daysIsolated=(w.daysIsolated||0)+1,w.daysIsolated>=7&&(w.population=0,w.daysIsolated=0)):w.daysIsolated=0,w.population>0&&(y<-20||Math.random()<_)&&(Math.random()<.05||Math.random()<_)&&(w.population-=1)):w.daysIsolated=0}else w.population>0&&(w.population=0);else if(w.type===z.INDUSTRIAL)if(O&&J){const W=A.get(J);W&&W.resTiles.length>0&&b>0?w.population<25*w.level&&Math.random()<b/100&&(w.population+=1,o.push({x:T,y:E,type:w.type})):w.population>0?(!W||W.resTiles.length===0?(w.daysIsolated=(w.daysIsolated||0)+1,w.daysIsolated>=7&&(w.population=0,w.daysIsolated=0)):w.daysIsolated=0,w.population>0&&(b<-20||Math.random()<_)&&(Math.random()<.05||Math.random()<_)&&(w.population-=1)):w.daysIsolated=0}else w.population>0&&(w.population=0)}return He.set(h),S}),ve.update(C=>{let h=[...C];const S=se(Te),N=new Map;for(const M of h)M.work&&!M.left&&N.set(M.work,(N.get(M.work)||0)+1);const k=[];for(let M=0;M<K;M++)for(let I=0;I<K;I++){const j=S[M][I];if(j.type===z.COMMERCIAL||j.type===z.INDUSTRIAL){const q=he(I,M),D=N.get(q)||0,Q=j.population-D,V=new Set,ee=[{dx:0,dy:-1},{dx:0,dy:1},{dx:-1,dy:0},{dx:1,dy:0}];for(const{dx:X,dy:le}of ee){const ue=I+X,ke=M+le;if(ue>=0&&ue<K&&ke>=0&&ke<K&&S[ke][ue].type===z.ROAD){const ie=$[ke][ue];ie&&V.add(ie)}}for(let X=0;X<Q;X++)k.push({x:I,y:M,type:j.type,addr:q,networks:Array.from(V)})}}for(let M=k.length-1;M>0;M--){const I=Math.floor(Math.random()*(M+1));[k[M],k[I]]=[k[I],k[M]]}const Y=M=>{const I=g(M);if(!I)return-1;const j=new Set,q=[{dx:0,dy:-1},{dx:0,dy:1},{dx:-1,dy:0},{dx:1,dy:0}];for(const{dx:D,dy:Q}of q){const V=I.x+D,ee=I.y+Q;if(V>=0&&V<K&&ee>=0&&ee<K&&S[ee][V].type===z.ROAD){const X=$[ee][V];X&&j.add(X)}}return k.findIndex(D=>D.networks.some(Q=>j.has(Q)))},E=[],T=[],w=[];for(let M=0;M<h.length;M++){const I=h[M];let j=!1;r.has(I.id)?I.daysMissed>0&&(I.daysMissed=0,j=!0):l.has(I.id)&&(I.daysMissed=(I.daysMissed||0)+1,j=!0,I.daysMissed>=7&&(I.work&&i("Fired for not showing up!",I,{x:-1,y:-1}),I.work=null,I.daysMissed=0,I.unemployedDays=0,I.history.push({type:"fired",time:t}))),!I.work&&!I.left?(I.unemployedDays=(I.unemployedDays||0)+1,j=!0,I.unemployedDays>30&&T.push({x:-1,y:-1,denizenId:I.id})):I.work&&I.unemployedDays>0&&(I.unemployedDays=0,j=!0),j&&(h[M]={...I})}let J=[...n],O=[...e];for(;J.length>0&&O.length>0;){const M=J.shift(),I=O.shift();E.push({from:M,to:I})}T.push(...J),w.push(...O);for(const M of E){const I=he(M.from.x,M.from.y),j=he(M.to.x,M.to.y),q=h.findIndex(D=>D.home===I&&!D.left);if(q!==-1){const D={...h[q]};if(D.history=[...D.history||[],{type:"move",time:t,from:I,to:j}],D.home=j,!D.work&&k.length>0){const Q=Y(D.home);if(Q!==-1){const V=k.splice(Q,1)[0];D.work=V.addr,D.history.push({type:"new_job",time:t,work:D.work})}}if(h[q]=D,Math.random()<.1){const Q={x:M.to.x,y:M.to.y,isGrowth:!0};i(`Moved from ${I} to ${j}. Fresh start!`,D,Q)}}else T.push(M.from),w.push(M.to)}if(k.length>0)for(let M=0;M<h.length&&k.length!==0;M++){const I=h[M];if(!I.left&&!I.work){const j=Y(I.home);if(j!==-1){const q=k.splice(j,1)[0],D=q.addr,Q={...I};if(Q.work=D,Q.history=[...I.history||[],{type:"new_job",time:t,work:D}],h[M]=Q,Math.random()<.3){const V=[`Finally got a job at ${D}!`,`Hired! Starting work at ${D}.`,`Off to work at ${D}. So happy!`,`Unemployment over. Hello ${D}.`],ee=V[Math.floor(Math.random()*V.length)];i(ee,Q,{x:q.x,y:q.y,type:q.type})}}}}for(const M of T){const I=he(M.x,M.y),j=h.findIndex(q=>q.home===I&&!q.left);if(j!==-1){const q={...h[j]};q.left=t,q.history=[...q.history||[],{type:"left_city",time:t}];for(const D of s)D.context&&D.context.isLeaving&&D.context.x===M.x&&D.context.y===M.y&&(D.author||(D.author=q));h[j]=q}}const te=[];for(const M of w){const I=he(M.x,M.y);let j=null;if(k.length>0){const D=Y(I);D!==-1&&(j=k.splice(D,1)[0].addr)}const q={id:Ge()+Math.random(),name:Ge(),home:I,work:j,since:t,history:[{type:"move_in",time:t,home:I}],isSystem:!1,personality:Ct(),playerInteractions:[]};te.push(q),h.push(q)}for(const M of s){let I=M.author;if(!I&&M.context){if(M.context.isGrowth){let j=te.find(q=>q.home===he(M.context.x,M.context.y));if(!j){const q=he(M.context.x,M.context.y);j=h.find(D=>D.home===q&&!D.left)}j&&(I=j)}else if(!M.context.isLeaving){if(M.context.x!=null){const j=h.find(q=>q.home===he(M.context.x,M.context.y)&&!q.left);j&&(I=j)}}}we(M.text,I,M.context)}const W=new Map,B=new Map;for(let M=0;M<h.length;M++){const I=h[M];I.left||(I.home&&(W.has(I.home)||W.set(I.home,[]),W.get(I.home).push(M)),I.work&&(B.has(I.work)||B.set(I.work,[]),B.get(I.work).push(M)))}for(let M=0;M<K;M++)for(let I=0;I<K;I++){const j=S[M][I],q=he(I,M),D=W.get(q)||[];if(j.type===z.RESIDENTIAL){if(D.length>j.population){const V=D.length-j.population;for(let ee=0;ee<V;ee++){const X=D.pop(),le=h[X],ue={...le,left:t,history:[...le.history||[],{type:"evicted",time:t}]};h[X]=ue}}else if(D.length<j.population){const V=j.population-D.length;for(let ee=0;ee<V;ee++){const X={id:Ge()+Math.random(),name:Ge(),home:q,work:null,since:t,history:[{type:"drift_correction_spawn",time:t,home:q}],isSystem:!1,personality:Ct(),playerInteractions:[]};h.push(X)}}}else if(D.length>0)for(const V of D){const ee=h[V],X={...ee,left:t,history:[...ee.history||[],{type:"evicted_bulldoze",time:t}]};h[V]=X}const Q=B.get(q)||[];if(j.type===z.COMMERCIAL||j.type===z.INDUSTRIAL)if(Q.length>j.population){const V=Q.length-j.population;for(let ee=0;ee<V;ee++){const X=Q.pop(),le=h[X],ue={...le,work:null,history:[...le.history||[],{type:"fired_excess",time:t}]};h[X]=ue,le.isSystem||i("Laid off due to downsizing.",ue,{x:I,y:M,type:j.type})}}else Q.length<j.population}for(let M=0;M<h.length;M++){const I=h[M];if(!I.left&&I.work){const j=g(I.work);let q=!1;if(j){const D=S[j.y][j.x];(D.type===z.COMMERCIAL||D.type===z.INDUSTRIAL)&&(q=!0)}if(!q){const D={...I,work:null,history:[...I.history||[],{type:"workplace_demolished",time:t}]};h[M]=D}}}return h});{const C=se(ve),h=new Map;for(const S of C)!S.left&&S.work&&h.set(S.work,(h.get(S.work)||0)+1);Te.update(S=>S.map((N,k)=>N.map((Y,E)=>{if(Y.type===z.COMMERCIAL||Y.type===z.INDUSTRIAL){const T=he(E,k),w=h.get(T)||0;if(Y.population>w)return{...Y,population:w}}return Y})))}if(e.length>0&&Math.random()<.05){const C=["Moving in today! So excited.","Boxes unpacked. Hello city!","Just got the keys to my new place.","New in town, looking for recommendations.","Wow, this city is growing fast!"],h=se(ve).filter(S=>S.since===t&&!S.isSystem);if(h.length>0){const S=h[Math.floor(Math.random()*h.length)];we(C[Math.floor(Math.random()*C.length)],S)}}if(Math.random()<.01){const C=["I love the smell of industry in the morning.","We need more parks!","Traffic is getting bad.","Is there a coffee shop nearby?","The mayor is doing a great job... I think.","Why is the power always out? Oh wait, it works."];we(C[Math.floor(Math.random()*C.length)])}const P=se(nt).filter(C=>C.respondAt===t);for(const C of P){const h=se(ve).find(S=>S.name===C.denizenName&&!S.left);if(h)if(C.forcedResponse)we(C.forcedResponse,h);else{const S=Hn(C.playerTweet,h),N=Bn(h,C.playerTweet,S);we(N,h)}}if(nt.update(C=>C.filter(h=>h.respondAt>t)),se(_e)%120===0&&Math.random()<.3){const h=se(ve).filter(S=>!S.left&&(S.unemployedDays>10||S.daysMissed>3||S.work&&se(_e)-S.since>50));if(h.length>0){const S=h[Math.floor(Math.random()*h.length)],N=Yn(S);we(N,S)}}se(_e)%5===0&&tt.update(C=>C+Math.floor(se(He)*.5))}function Rt(t,e,n){let o=999;for(const s of n){const l=Math.sqrt(Math.pow(s.x-t,2)+Math.pow(s.y-e,2));l<o&&(o=l)}return o}function Qn(t){const e=Array(K).fill(null).map(()=>Array(K).fill(0)),n=[];for(let o=0;o<K;o++)for(let s=0;s<K;s++)t[o][s].type===z.INDUSTRIAL&&n.push({x:s,y:o,intensity:10+t[o][s].population});if(n.length>0)for(let o=0;o<K;o++)for(let s=0;s<K;s++){let l=0;for(const r of n){const i=Math.sqrt(Math.pow(r.x-s,2)+Math.pow(r.y-o,2));i<8&&(l+=r.intensity/(i+1))}e[o][s]=l}return e}function jt(t,e,n){const o=[],s=[{dx:0,dy:0},{dx:0,dy:-1},{dx:0,dy:1},{dx:-1,dy:0},{dx:1,dy:0}];for(const{dx:l,dy:r}of s){const i=t+l,c=e+r;i>=0&&i<K&&c>=0&&c<K&&n[c][i].type===z.ROAD&&o.push({x:i,y:c})}return o}function eo(t,e,n){if(!t||t.length===0||!e||e.length===0)return null;const o=new Set(e.map(r=>`${r.x},${r.y}`)),s=t.map(r=>({x:r.x,y:r.y,path:[{x:r.x,y:r.y}]})),l=new Set(t.map(r=>`${r.x},${r.y}`));for(;s.length>0;){const{x:r,y:i,path:c}=s.shift();if(o.has(`${r},${i}`))return c;const a=[{dx:0,dy:-1},{dx:0,dy:1},{dx:-1,dy:0},{dx:1,dy:0}];for(const{dx:u,dy:p}of a){const y=r+u,b=i+p;y>=0&&y<K&&b>=0&&b<K&&!l.has(`${y},${b}`)&&n[b][y].type===z.ROAD&&(l.add(`${y},${b}`),s.push({x:y,y:b,path:[...c,{x:y,y:b}]}))}}return null}function to(t){const e=new Map,n=Array(K).fill(null).map(()=>Array(K).fill(0));let o=1;const s=new Set;for(let l=0;l<K;l++)for(let r=0;r<K;r++)if(t[l][r].type===z.ROAD&&!s.has(`${r},${l}`)){const i=o++;e.set(i,{jobTiles:[],resTiles:[],roadCount:0});const c=[{x:r,y:l}];for(s.add(`${r},${l}`),n[l][r]=i,e.get(i).roadCount++;c.length>0;){const{x:a,y:u}=c.shift();[{dx:0,dy:-1},{dx:0,dy:1},{dx:-1,dy:0},{dx:1,dy:0}].forEach(({dx:y,dy:b})=>{const d=a+y,$=u+b;if(d>=0&&d<K&&$>=0&&$<K){const A=t[$][d];if(A.type===z.ROAD)s.has(`${d},${$}`)||(s.add(`${d},${$}`),n[$][d]=i,e.get(i).roadCount++,c.push({x:d,y:$}));else{const R=e.get(i);A.type===z.RESIDENTIAL?R.resTiles.some(g=>g.x===d&&g.y===$)||R.resTiles.push({x:d,y:$}):(A.type===z.COMMERCIAL||A.type===z.INDUSTRIAL)&&(R.jobTiles.some(g=>g.x===d&&g.y===$)||R.jobTiles.push({x:d,y:$}))}}})}}return{roadNetworkMap:n,networks:e}}function no(t,e,n){const o=se(tt),s=et[n];if(o>=s){const r=se(Te)[e][t];if(r.type===z.ROAD&&n!==z.ROAD){if(Math.random()<.7){const i=ut(t,e),c=[`@Mayor Hey! I used the road at ${i} to get to work!`,`@Mayor My commute just got ruined by work at ${i}.`,`@Mayor Why are we destroying infrastructure at ${i}?`,`@Mayor Now I have to take the long way around ${i}.`,`@Mayor Bulldozers at ${i} woke me up!`];we(c[Math.floor(Math.random()*c.length)])}}else if(r.type!==n&&n!==z.EMPTY&&n!==z.ROAD&&Math.random()<.4){const i=ut(t,e),c=ft(n,t,e);let a=[];n===z.RESIDENTIAL?a=[`New housing coming to ${i}. Nice!`,`Looks like they are building ${c}.`,`More neighbors at ${i}. Hope they are quiet.`,`Finally developing the lot at ${i}.`]:n===z.COMMERCIAL?a=[`Ooh, a new shop opening at ${i}?`,`I heard ${c} is being built.`,`Traffic is going to be bad at ${i} with all the shoppers.`,`Can't wait to visit ${c}!`]:n===z.INDUSTRIAL?a=[`Ugh, they are building a factory at ${i}.`,`There goes the neighborhood. ${c} is huge.`,`More jobs at ${i}, but at what cost?`,`I hope ${c} doesn't smell bad.`]:n===z.PARK&&(a=[`Yay! A new park at ${i}.`,`Love that they preserved green space at ${i}.`,`Going to take my dog to ${c}.`,`Picnic time at ${i}!`]),a.length>0&&we(a[Math.floor(Math.random()*a.length)])}tt.update(i=>i-s),Te.update(i=>{const c=[...i];return c[e][t]={...c[e][t],type:n,population:0,level:1},c})}}function Lt(t,e,n){const o=t.slice();return o[10]=e[n],o}function oo(t){let e,n,o,s,l,r,i,c,a=t[1].length+"",u,p,y,b,d=t[1].filter(Nt).length+"",$,A,R,g,L=t[1].filter(zt).length+"",_,F,P,C,h,S,N,k,Y,E=ce(t[3]),T=[];for(let w=0;w<E.length;w+=1)T[w]=xt(Lt(t,E,w));return{c(){e=m("section"),n=m("h3"),n.textContent="Denizen Debugger",o=x(),s=m("input"),l=x(),r=m("div"),i=m("span"),c=U("Total: "),u=U(a),p=x(),y=m("span"),b=U("Active: "),$=U(d),A=x(),R=m("span"),g=U("Employed: "),_=U(L),F=x(),P=m("div"),C=m("table"),h=m("thead"),h.innerHTML='<tr><th class="svelte-1av673s">Name</th> <th class="svelte-1av673s">Home</th> <th class="svelte-1av673s">Work</th> <th class="svelte-1av673s">Status</th> <th class="svelte-1av673s">Missed</th> <th class="svelte-1av673s">Unemployed</th></tr>',S=x(),N=m("tbody");for(let w=0;w<T.length;w+=1)T[w].c();v(n,"class","svelte-1av673s"),v(s,"type","text"),v(s,"placeholder","Search name, home, work..."),v(s,"class","search-input svelte-1av673s"),v(r,"class","stats-row svelte-1av673s"),v(C,"class","svelte-1av673s"),v(P,"class","table-container svelte-1av673s"),v(e,"class","debug-section svelte-1av673s")},m(w,J){H(w,e,J),f(e,n),f(e,o),f(e,s),Ze(s,t[0]),f(e,l),f(e,r),f(r,i),f(i,c),f(i,u),f(r,p),f(r,y),f(y,b),f(y,$),f(r,A),f(r,R),f(R,g),f(R,_),f(e,F),f(e,P),f(P,C),f(C,h),f(C,S),f(C,N);for(let O=0;O<T.length;O+=1)T[O]&&T[O].m(N,null);k||(Y=re(s,"input",t[8]),k=!0)},p(w,J){if(J&1&&s.value!==w[0]&&Ze(s,w[0]),J&2&&a!==(a=w[1].length+"")&&ne(u,a),J&2&&d!==(d=w[1].filter(Nt).length+"")&&ne($,d),J&2&&L!==(L=w[1].filter(zt).length+"")&&ne(_,L),J&8){E=ce(w[3]);let O;for(O=0;O<E.length;O+=1){const te=Lt(w,E,O);T[O]?T[O].p(te,J):(T[O]=xt(te),T[O].c(),T[O].m(N,null))}for(;O<T.length;O+=1)T[O].d(1);T.length=E.length}},d(w){w&&G(e),Ie(T,w),k=!1,Y()}}}function so(t){let e,n,o;return{c(){e=m("section"),e.innerHTML='<h3 class="svelte-1av673s">Zones</h3> <div class="legend-item svelte-1av673s"><div class="swatch res svelte-1av673s"></div> <div class="desc svelte-1av673s"><strong class="svelte-1av673s">Residential (Green)</strong> <p class="svelte-1av673s">Where people live. Darkens as population grows.</p></div></div> <div class="legend-item svelte-1av673s"><div class="swatch com svelte-1av673s"></div> <div class="desc svelte-1av673s"><strong class="svelte-1av673s">Commercial (Blue)</strong> <p class="svelte-1av673s">Shops and offices. Needs people and goods.</p></div></div> <div class="legend-item svelte-1av673s"><div class="swatch ind svelte-1av673s"></div> <div class="desc svelte-1av673s"><strong class="svelte-1av673s">Industrial (Yellow)</strong> <p class="svelte-1av673s">Factories. Creates jobs and goods.</p></div></div> <div class="legend-item svelte-1av673s"><div class="swatch park svelte-1av673s"></div> <div class="desc svelte-1av673s"><strong class="svelte-1av673s">Park (Dark Green)</strong> <p class="svelte-1av673s">Increases happiness of nearby residents.</p></div></div>',n=x(),o=m("section"),o.innerHTML='<h3 class="svelte-1av673s">Traffic Indicators</h3> <p class="section-desc svelte-1av673s">Moving dots on roads indicate traffic flow.</p> <div class="legend-item svelte-1av673s"><div class="traffic-swatch svelte-1av673s"><div class="dot green svelte-1av673s"></div></div> <div class="desc svelte-1av673s"><strong class="svelte-1av673s">Green Dot</strong> <p class="svelte-1av673s">Light traffic. Free flowing.</p></div></div> <div class="legend-item svelte-1av673s"><div class="traffic-swatch svelte-1av673s"><div class="dot amber svelte-1av673s"></div></div> <div class="desc svelte-1av673s"><strong class="svelte-1av673s">Amber Dot</strong> <p class="svelte-1av673s">Moderate traffic.</p></div></div> <div class="legend-item svelte-1av673s"><div class="traffic-swatch svelte-1av673s"><div class="dot red svelte-1av673s"></div></div> <div class="desc svelte-1av673s"><strong class="svelte-1av673s">Red Dot</strong> <p class="svelte-1av673s">Heavy traffic. Congestion may slow growth.</p></div></div>'},m(s,l){H(s,e,l),H(s,n,l),H(s,o,l)},p:Z,d(s){s&&(G(e),G(n),G(o))}}}function xt(t){let e,n,o=t[10].name+"",s,l,r,i=t[10].home+"",c,a,u,p=(t[10].work||"-")+"",y,b,d,$=t[10].left?"Left":"Active",A,R,g,L=(t[10].daysMissed||0)+"",_,F,P,C=(t[10].unemployedDays||0)+"",h,S;return{c(){e=m("tr"),n=m("td"),s=U(o),l=x(),r=m("td"),c=U(i),a=x(),u=m("td"),y=U(p),b=x(),d=m("td"),A=U($),R=x(),g=m("td"),_=U(L),F=x(),P=m("td"),h=U(C),S=x(),v(n,"class","svelte-1av673s"),v(r,"class","svelte-1av673s"),v(u,"class","svelte-1av673s"),v(d,"class","svelte-1av673s"),v(g,"class","svelte-1av673s"),v(P,"class","svelte-1av673s"),v(e,"class","svelte-1av673s"),ye(e,"left",t[10].left)},m(N,k){H(N,e,k),f(e,n),f(n,s),f(e,l),f(e,r),f(r,c),f(e,a),f(e,u),f(u,y),f(e,b),f(e,d),f(d,A),f(e,R),f(e,g),f(g,_),f(e,F),f(e,P),f(P,h),f(e,S)},p(N,k){k&8&&o!==(o=N[10].name+"")&&ne(s,o),k&8&&i!==(i=N[10].home+"")&&ne(c,i),k&8&&p!==(p=(N[10].work||"-")+"")&&ne(y,p),k&8&&$!==($=N[10].left?"Left":"Active")&&ne(A,$),k&8&&L!==(L=(N[10].daysMissed||0)+"")&&ne(_,L),k&8&&C!==(C=(N[10].unemployedDays||0)+"")&&ne(h,C),k&8&&ye(e,"left",N[10].left)},d(N){N&&G(e)}}}function lo(t){let e,n,o,s,l,r,i,c,a,u,p,y,b;function d(R,g){return R[2]?oo:so}let $=d(t),A=$(t);return{c(){e=m("div"),n=m("div"),o=m("button"),o.textContent="×",s=x(),l=m("h2"),l.textContent="Legend & Help",r=x(),i=m("div"),c=m("button"),c.textContent="Legend",a=x(),u=m("button"),u.textContent="Debug Tools",p=x(),A.c(),v(o,"class","close-btn svelte-1av673s"),v(l,"class","svelte-1av673s"),v(c,"class","svelte-1av673s"),ye(c,"active",!t[2]),v(u,"class","svelte-1av673s"),ye(u,"active",t[2]),v(i,"class","tabs svelte-1av673s"),v(n,"class","modal-content svelte-1av673s"),v(e,"class","modal-backdrop svelte-1av673s")},m(R,g){H(R,e,g),f(e,n),f(n,o),f(n,s),f(n,l),f(n,r),f(n,i),f(i,c),f(i,a),f(i,u),f(n,p),A.m(n,null),y||(b=[re(o,"click",t[4]),re(c,"click",t[6]),re(u,"click",t[7]),re(n,"click",dn(t[5])),re(e,"click",t[4])],y=!0)},p(R,[g]){g&4&&ye(c,"active",!R[2]),g&4&&ye(u,"active",R[2]),$===($=d(R))&&A?A.p(R,g):(A.d(1),A=$(R),A&&(A.c(),A.m(n,null)))},i:Z,o:Z,d(R){R&&G(e),A.d(),y=!1,me(b)}}}const Nt=t=>!t.left,zt=t=>!t.left&&t.work;function io(t,e,n){let o,s;ge(t,ve,b=>n(1,s=b));const l=Tn();let r=!1,i="";function c(){l("close")}function a(b){pn.call(this,t,b)}const u=()=>n(2,r=!1),p=()=>n(2,r=!0);function y(){i=this.value,n(0,i)}return t.$$.update=()=>{t.$$.dirty&3&&n(3,o=s.filter(b=>{if(!i)return!0;const d=i.toLowerCase();return b.name.toLowerCase().includes(d)||b.home.toLowerCase().includes(d)||b.work&&b.work.toLowerCase().includes(d)}))},[i,s,r,o,c,a,u,p,y]}class ro extends Re{constructor(e){super(),De(this,e,io,lo,Ae,{})}}function Ot(t){let e,n;return e=new ro({}),e.$on("close",t[6]),{c(){Ne(e.$$.fragment)},m(o,s){Ce(e,o,s),n=!0},p:Z,i(o){n||(oe(e.$$.fragment,o),n=!0)},o(o){fe(e.$$.fragment,o),n=!1},d(o){Se(e,o)}}}function ao(t){let e,n,o,s,l,r,i,c,a,u,p,y,b,d,$,A,R,g,L,_,F,P,C,h,S,N,k,Y,E,T,w,J,O,te,W,B,M,I,j,q,D,Q,V,ee,X,le,ue,ke,ie=t[0]&&Ot(t);return{c(){e=m("header"),n=m("div"),o=m("span"),o.textContent="Money",s=x(),l=m("span"),r=U("$"),i=U(t[1]),c=x(),a=m("div"),u=m("span"),u.textContent="Population",p=x(),y=m("span"),b=U(t[2]),d=x(),$=m("div"),A=m("span"),A.textContent="Day",R=x(),g=m("span"),L=U(t[3]),_=x(),F=m("div"),P=m("div"),P.textContent="RCI",C=x(),h=m("div"),S=m("div"),N=m("div"),k=m("div"),Y=x(),E=m("span"),E.textContent="R",T=x(),w=m("div"),J=m("div"),O=m("div"),te=x(),W=m("span"),W.textContent="C",B=x(),M=m("div"),I=m("div"),j=m("div"),q=x(),D=m("span"),D.textContent="I",Q=x(),V=m("button"),V.textContent="?",ee=x(),ie&&ie.c(),X=mt(),v(o,"class","label svelte-1ylazd0"),v(l,"class","value svelte-1ylazd0"),v(n,"class","stat svelte-1ylazd0"),v(u,"class","label svelte-1ylazd0"),v(y,"class","value svelte-1ylazd0"),v(a,"class","stat svelte-1ylazd0"),v(A,"class","label svelte-1ylazd0"),v(g,"class","value svelte-1ylazd0"),v($,"class","stat svelte-1ylazd0"),v(P,"class","rci-label svelte-1ylazd0"),v(k,"class","bar res svelte-1ylazd0"),pe(k,"height",Math.max(5,Math.min(100,t[4].residential))+"%"),v(N,"class","bar-track svelte-1ylazd0"),v(E,"class","bar-label svelte-1ylazd0"),v(S,"class","bar-group svelte-1ylazd0"),v(O,"class","bar com svelte-1ylazd0"),pe(O,"height",Math.max(5,Math.min(100,t[4].commercial))+"%"),v(J,"class","bar-track svelte-1ylazd0"),v(W,"class","bar-label svelte-1ylazd0"),v(w,"class","bar-group svelte-1ylazd0"),v(j,"class","bar ind svelte-1ylazd0"),pe(j,"height",Math.max(5,Math.min(100,t[4].industrial))+"%"),v(I,"class","bar-track svelte-1ylazd0"),v(D,"class","bar-label svelte-1ylazd0"),v(M,"class","bar-group svelte-1ylazd0"),v(h,"class","bars svelte-1ylazd0"),v(F,"class","rci-container svelte-1ylazd0"),v(V,"class","help-btn svelte-1ylazd0"),v(V,"title","Legend & Help"),v(e,"class","svelte-1ylazd0")},m(ae,de){H(ae,e,de),f(e,n),f(n,o),f(n,s),f(n,l),f(l,r),f(l,i),f(e,c),f(e,a),f(a,u),f(a,p),f(a,y),f(y,b),f(e,d),f(e,$),f($,A),f($,R),f($,g),f(g,L),f(e,_),f(e,F),f(F,P),f(F,C),f(F,h),f(h,S),f(S,N),f(N,k),f(S,Y),f(S,E),f(h,T),f(h,w),f(w,J),f(J,O),f(w,te),f(w,W),f(h,B),f(h,M),f(M,I),f(I,j),f(M,q),f(M,D),f(e,Q),f(e,V),H(ae,ee,de),ie&&ie.m(ae,de),H(ae,X,de),le=!0,ue||(ke=re(V,"click",t[5]),ue=!0)},p(ae,[de]){(!le||de&2)&&ne(i,ae[1]),(!le||de&4)&&ne(b,ae[2]),(!le||de&8)&&ne(L,ae[3]),(!le||de&16)&&pe(k,"height",Math.max(5,Math.min(100,ae[4].residential))+"%"),(!le||de&16)&&pe(O,"height",Math.max(5,Math.min(100,ae[4].commercial))+"%"),(!le||de&16)&&pe(j,"height",Math.max(5,Math.min(100,ae[4].industrial))+"%"),ae[0]?ie?(ie.p(ae,de),de&1&&oe(ie,1)):(ie=Ot(ae),ie.c(),oe(ie,1),ie.m(X.parentNode,X)):ie&&(Pe(),fe(ie,1,1,()=>{ie=null}),qe())},i(ae){le||(oe(ie),le=!0)},o(ae){fe(ie),le=!1},d(ae){ae&&(G(e),G(ee),G(X)),ie&&ie.d(ae),ue=!1,ke()}}}function co(t,e,n){let o,s,l,r;ge(t,tt,u=>n(1,o=u)),ge(t,He,u=>n(2,s=u)),ge(t,_e,u=>n(3,l=u)),ge(t,mn,u=>n(4,r=u));let i=!1;return[i,o,s,l,r,()=>n(0,i=!0),()=>n(0,i=!1)]}class fo extends Re{constructor(e){super(),De(this,e,co,ao,Ae,{})}}function Pt(t,e,n){const o=t.slice();return o[3]=e[n],o}function uo(t){let e;return{c(){e=m("span"),e.textContent=`$${et[t[3].id]}`,v(e,"class","cost svelte-omakiu")},m(n,o){H(n,e,o)},p:Z,d(n){n&&G(e)}}}function qt(t){let e,n,o,s,l,r,i=et[t[3].id]&&uo(t);function c(){return t[2](t[3])}return{c(){e=m("button"),n=m("span"),n.textContent=`${t[3].label}`,o=x(),i&&i.c(),s=x(),v(n,"class","label svelte-omakiu"),pe(e,"--color",t[3].color),v(e,"class","svelte-omakiu"),ye(e,"active",t[0]===t[3].id)},m(a,u){H(a,e,u),f(e,n),f(e,o),i&&i.m(e,null),f(e,s),l||(r=re(e,"click",c),l=!0)},p(a,u){t=a,et[t[3].id]&&i.p(t,u),u&3&&ye(e,"active",t[0]===t[3].id)},d(a){a&&G(e),i&&i.d(),l=!1,r()}}}function ho(t){let e,n=ce(t[1]),o=[];for(let s=0;s<n.length;s+=1)o[s]=qt(Pt(t,n,s));return{c(){e=m("div");for(let s=0;s<o.length;s+=1)o[s].c();v(e,"class","toolbar svelte-omakiu")},m(s,l){H(s,e,l);for(let r=0;r<o.length;r+=1)o[r]&&o[r].m(e,null)},p(s,[l]){if(l&3){n=ce(s[1]);let r;for(r=0;r<n.length;r+=1){const i=Pt(s,n,r);o[r]?o[r].p(i,l):(o[r]=qt(i),o[r].c(),o[r].m(e,null))}for(;r<o.length;r+=1)o[r].d(1);o.length=n.length}},i:Z,o:Z,d(s){s&&G(e),Ie(o,s)}}}function po(t,e,n){let o;ge(t,ct,r=>n(0,o=r));const s=[{id:z.RESIDENTIAL,label:"Res",color:"#4ade80"},{id:z.COMMERCIAL,label:"Com",color:"#60a5fa"},{id:z.INDUSTRIAL,label:"Ind",color:"#facc15"},{id:z.ROAD,label:"Road",color:"#4b5563"},{id:z.PARK,label:"Park",color:"#15803d"},{id:z.EMPTY,label:"Bulldoze",color:"#ef4444"}];return[o,s,r=>ct.set(r.id)]}class yo extends Re{constructor(e){super(),De(this,e,po,ho,Ae,{})}}function mo(t){let e;function n(l,r){return l[0].traffic>0?_o:vo}let o=n(t),s=o(t);return{c(){s.c(),e=mt()},m(l,r){s.m(l,r),H(l,e,r)},p(l,r){o===(o=n(l))&&s?s.p(l,r):(s.d(1),s=o(l),s&&(s.c(),s.m(e.parentNode,e)))},d(l){l&&G(e),s.d(l)}}}function go(t){let e,n=t[0].population+"",o;return{c(){e=m("span"),o=U(n),v(e,"class","pop svelte-194cfaq")},m(s,l){H(s,e,l),f(e,o)},p(s,l){l&1&&n!==(n=s[0].population+"")&&ne(o,n)},d(s){s&&G(e)}}}function vo(t){let e;return{c(){e=m("span"),e.textContent="•",v(e,"class","road-mark svelte-194cfaq")},m(n,o){H(n,e,o)},p:Z,d(n){n&&G(e)}}}function _o(t){let e,n;return{c(){e=m("div"),n=m("div"),v(n,"class","car svelte-194cfaq"),pe(n,"background-color",Wt(t[0].traffic)),v(e,"class","traffic-container svelte-194cfaq"),pe(e,"animation-duration",3/(1+t[0].traffic*.1)+"s")},m(o,s){H(o,e,s),f(e,n)},p(o,s){s&1&&pe(n,"background-color",Wt(o[0].traffic)),s&1&&pe(e,"animation-duration",3/(1+o[0].traffic*.1)+"s")},d(o){o&&G(e)}}}function Mo(t){let e,n,o;function s(i,c){if(i[0].population>0)return go;if(i[0].type==="road")return mo}let l=s(t),r=l&&l(t);return{c(){e=m("div"),r&&r.c(),v(e,"class","tile svelte-194cfaq"),pe(e,"background-color",t[1]),v(e,"role","button")},m(i,c){H(i,e,c),r&&r.m(e,null),n||(o=re(e,"click",t[2]),n=!0)},p(i,[c]){l===(l=s(i))&&r?r.p(i,c):(r&&r.d(1),r=l&&l(i),r&&(r.c(),r.m(e,null))),c&2&&pe(e,"background-color",i[1])},i:Z,o:Z,d(i){i&&G(e),r&&r.d(),n=!1,o()}}}function wo(t,e){let n;switch(t){case"residential":n=[74,222,128];break;case"commercial":n=[96,165,250];break;case"industrial":n=[250,204,21];break;case"road":return"#4b5563";case"park":return"#14532d";default:return"#f3f4f6"}const l=1-Math.min(1,e/(t==="residential"?50:25))*.4;return`rgb(${Math.floor(n[0]*l)}, ${Math.floor(n[1]*l)}, ${Math.floor(n[2]*l)})`}function Wt(t){return t>5?"#ef4444":t>2?"#fbbf24":"#4ade80"}function bo(t,e,n){let o,s;ge(t,ct,a=>n(5,s=a));let{x:l}=e,{y:r}=e,{tile:i}=e;function c(){no(l,r,s)}return t.$$set=a=>{"x"in a&&n(3,l=a.x),"y"in a&&n(4,r=a.y),"tile"in a&&n(0,i=a.tile)},t.$$.update=()=>{t.$$.dirty&1&&n(1,o=wo(i.type,i.population))},[i,o,c,l,r]}class ko extends Re{constructor(e){super(),De(this,e,bo,Mo,Ae,{x:3,y:4,tile:0})}}function Gt(t,e,n){const o=t.slice();return o[3]=e[n],o[5]=n,o}function Ut(t,e,n){const o=t.slice();return o[6]=e[n],o[8]=n,o}function Ht(t,e,n){const o=t.slice();return o[3]=e[n],o}function Ft(t,e,n){const o=t.slice();return o[11]=e[n],o}function Bt(t){let e;return{c(){e=m("div"),e.textContent=`${t[11]}`,v(e,"class","col-label svelte-1sqmj97")},m(n,o){H(n,e,o)},p:Z,d(n){n&&G(e)}}}function Yt(t){let e;return{c(){e=m("div"),e.textContent=`${t[3]}`,v(e,"class","row-label svelte-1sqmj97")},m(n,o){H(n,e,o)},p:Z,d(n){n&&G(e)}}}function Kt(t){let e,n;return e=new ko({props:{x:t[8],y:t[5],tile:t[6]}}),{c(){Ne(e.$$.fragment)},m(o,s){Ce(e,o,s),n=!0},p(o,s){const l={};s&1&&(l.tile=o[6]),e.$set(l)},i(o){n||(oe(e.$$.fragment,o),n=!0)},o(o){fe(e.$$.fragment,o),n=!1},d(o){Se(e,o)}}}function Zt(t){let e,n,o,s=ce(t[3]),l=[];for(let i=0;i<s.length;i+=1)l[i]=Kt(Ut(t,s,i));const r=i=>fe(l[i],1,1,()=>{l[i]=null});return{c(){e=m("div");for(let i=0;i<l.length;i+=1)l[i].c();n=x(),v(e,"class","row svelte-1sqmj97")},m(i,c){H(i,e,c);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null);f(e,n),o=!0},p(i,c){if(c&1){s=ce(i[3]);let a;for(a=0;a<s.length;a+=1){const u=Ut(i,s,a);l[a]?(l[a].p(u,c),oe(l[a],1)):(l[a]=Kt(u),l[a].c(),oe(l[a],1),l[a].m(e,n))}for(Pe(),a=s.length;a<l.length;a+=1)r(a);qe()}},i(i){if(!o){for(let c=0;c<s.length;c+=1)oe(l[c]);o=!0}},o(i){l=l.filter(Boolean);for(let c=0;c<l.length;c+=1)fe(l[c]);o=!1},d(i){i&&G(e),Ie(l,i)}}}function Io(t){let e,n,o,s,l,r,i,c,a,u,p=ce(t[1]),y=[];for(let g=0;g<p.length;g+=1)y[g]=Bt(Ft(t,p,g));let b=ce(t[2]),d=[];for(let g=0;g<b.length;g+=1)d[g]=Yt(Ht(t,b,g));let $=ce(t[0]),A=[];for(let g=0;g<$.length;g+=1)A[g]=Zt(Gt(t,$,g));const R=g=>fe(A[g],1,1,()=>{A[g]=null});return{c(){e=m("div"),n=m("div"),o=m("div"),s=x();for(let g=0;g<y.length;g+=1)y[g].c();l=x(),r=m("div"),i=m("div");for(let g=0;g<d.length;g+=1)d[g].c();c=x(),a=m("div");for(let g=0;g<A.length;g+=1)A[g].c();v(o,"class","corner svelte-1sqmj97"),v(n,"class","header-row svelte-1sqmj97"),v(i,"class","row-labels svelte-1sqmj97"),v(a,"class","grid-container svelte-1sqmj97"),v(r,"class","main-area svelte-1sqmj97"),v(e,"class","layout svelte-1sqmj97")},m(g,L){H(g,e,L),f(e,n),f(n,o),f(n,s);for(let _=0;_<y.length;_+=1)y[_]&&y[_].m(n,null);f(e,l),f(e,r),f(r,i);for(let _=0;_<d.length;_+=1)d[_]&&d[_].m(i,null);f(r,c),f(r,a);for(let _=0;_<A.length;_+=1)A[_]&&A[_].m(a,null);u=!0},p(g,[L]){if(L&2){p=ce(g[1]);let _;for(_=0;_<p.length;_+=1){const F=Ft(g,p,_);y[_]?y[_].p(F,L):(y[_]=Bt(F),y[_].c(),y[_].m(n,null))}for(;_<y.length;_+=1)y[_].d(1);y.length=p.length}if(L&4){b=ce(g[2]);let _;for(_=0;_<b.length;_+=1){const F=Ht(g,b,_);d[_]?d[_].p(F,L):(d[_]=Yt(F),d[_].c(),d[_].m(i,null))}for(;_<d.length;_+=1)d[_].d(1);d.length=b.length}if(L&1){$=ce(g[0]);let _;for(_=0;_<$.length;_+=1){const F=Gt(g,$,_);A[_]?(A[_].p(F,L),oe(A[_],1)):(A[_]=Zt(F),A[_].c(),oe(A[_],1),A[_].m(a,null))}for(Pe(),_=$.length;_<A.length;_+=1)R(_);qe()}},i(g){if(!u){for(let L=0;L<$.length;L+=1)oe(A[L]);u=!0}},o(g){A=A.filter(Boolean);for(let L=0;L<A.length;L+=1)fe(A[L]);u=!1},d(g){g&&G(e),Ie(y,g),Ie(d,g),Ie(A,g)}}}function $o(t,e,n){let o;ge(t,Te,r=>n(0,o=r));const s=Array.from({length:20},(r,i)=>i+1),l=Array.from({length:20},(r,i)=>String.fromCharCode(65+i));return[o,s,l]}class Ao extends Re{constructor(e){super(),De(this,e,$o,Io,Ae,{})}}function Co(t){const e=t-1;return e*e*e+1}function dt(t,{delay:e=0,duration:n=400,easing:o=ot}={}){const s=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:o,css:l=>`opacity: ${l*s}`}}function So(t,{delay:e=0,duration:n=400,easing:o=Co,x:s=0,y:l=0,opacity:r=0}={}){const i=getComputedStyle(t),c=+i.opacity,a=i.transform==="none"?"":i.transform,u=c*(1-r),[p,y]=wt(s),[b,d]=wt(l);return{delay:e,duration:n,easing:o,css:($,A)=>`
			transform: ${a} translate(${(1-$)*p}${y}, ${(1-$)*b}${d});
			opacity: ${c-u*A}`}}function Jt(t,e,n){const o=t.slice();return o[24]=e[n],o}function Vt(t,e,n){const o=t.slice();return o[27]=e[n],o}function Xt(t,e,n){const o=t.slice();return o[30]=e[n],o[32]=n,o}function Qt(t){let e,n=ce(t[4]),o=[];for(let s=0;s<n.length;s+=1)o[s]=en(Xt(t,n,s));return{c(){e=m("ul");for(let s=0;s<o.length;s+=1)o[s].c();v(e,"class","autocomplete-list svelte-1itj0d0")},m(s,l){H(s,e,l);for(let r=0;r<o.length;r+=1)o[r]&&o[r].m(e,null)},p(s,l){if(l[0]&560){n=ce(s[4]);let r;for(r=0;r<n.length;r+=1){const i=Xt(s,n,r);o[r]?o[r].p(i,l):(o[r]=en(i),o[r].c(),o[r].m(e,null))}for(;r<o.length;r+=1)o[r].d(1);o.length=n.length}},d(s){s&&G(e),Ie(o,s)}}}function en(t){let e,n,o=t[30]+"",s,l,r,i;function c(){return t[19](t[30])}function a(){return t[20](t[32])}return{c(){e=m("li"),n=U("@"),s=U(o),l=x(),v(e,"class","svelte-1itj0d0"),ye(e,"selected",t[32]===t[5])},m(u,p){H(u,e,p),f(e,n),f(e,s),f(e,l),r||(i=[re(e,"click",c),re(e,"mouseenter",a)],r=!0)},p(u,p){t=u,p[0]&16&&o!==(o=t[30]+"")&&ne(s,o),p[0]&32&&ye(e,"selected",t[32]===t[5])},d(u){u&&G(e),r=!1,me(i)}}}function To(t){let e;return{c(){e=m("div"),e.innerHTML="<p>No one lives here yet...</p>",v(e,"class","empty-state svelte-1itj0d0")},m(n,o){H(n,e,o)},p:Z,i:Z,o:Z,d(n){n&&G(e)}}}function Eo(t){let e=[],n=new Map,o,s,l=ce(t[0]);const r=i=>i[27].id;for(let i=0;i<l.length;i+=1){let c=Vt(t,l,i),a=r(c);n.set(a,e[i]=tn(a,c))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();o=mt()},m(i,c){for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(i,c);H(i,o,c),s=!0},p(i,c){c[0]&4097&&(l=ce(i[0]),Pe(),e=zn(e,c,r,1,i,l,n,o.parentNode,Nn,tn,o,Vt),qe())},i(i){if(!s){for(let c=0;c<l.length;c+=1)oe(e[c]);s=!0}},o(i){for(let c=0;c<e.length;c+=1)fe(e[c]);s=!1},d(i){i&&G(o);for(let c=0;c<e.length;c+=1)e[c].d(i)}}}function tn(t,e){let n,o,s,l=e[27].author.name+"",r,i,c,a=e[27].text+"",u,p,y,b=e[27].time+"",d,$,A,R,g,L,_;function F(){return e[21](e[27])}return{key:t,first:null,c(){n=m("div"),o=m("div"),s=U("@"),r=U(l),i=x(),c=m("div"),u=U(a),p=x(),y=m("div"),d=U(b),$=x(),v(o,"class","author svelte-1itj0d0"),ye(o,"clickable",!e[27].author.isSystem),v(c,"class","content svelte-1itj0d0"),v(y,"class","time svelte-1itj0d0"),v(n,"class","tweet svelte-1itj0d0"),this.first=n},m(P,C){H(P,n,C),f(n,o),f(o,s),f(o,r),f(n,i),f(n,c),f(c,u),f(n,p),f(n,y),f(y,d),f(n,$),g=!0,L||(_=re(o,"click",F),L=!0)},p(P,C){e=P,(!g||C[0]&1)&&l!==(l=e[27].author.name+"")&&ne(r,l),(!g||C[0]&1)&&ye(o,"clickable",!e[27].author.isSystem),(!g||C[0]&1)&&a!==(a=e[27].text+"")&&ne(u,a),(!g||C[0]&1)&&b!==(b=e[27].time+"")&&ne(d,b)},i(P){g||(P&&$e(()=>{g&&(R&&R.end(1),A=Ln(n,So,{y:20,duration:300}),A.start())}),g=!0)},o(P){A&&A.invalidate(),P&&(R=xn(n,dt,{})),g=!1},d(P){P&&G(n),P&&R&&R.end(),L=!1,_()}}}function nn(t){let e,n,o,s,l=t[2].name+"",r,i,c,a,u,p,y,b,d,$=t[2].home+"",A,R,g,L,_,F,P,C=t[2].since+"",h,S,N=t[2].left?`${t[2].left}`:"Now",k,Y,E,T,w,J,O=t[2].work&&on(t),te=t[2].history&&t[2].history.length>0&&sn(t);return{c(){e=m("div"),n=m("div"),o=m("div"),s=m("h4"),r=U(l),i=x(),c=m("button"),c.textContent="×",a=x(),u=m("div"),p=m("div"),y=m("span"),y.textContent="Home:",b=x(),d=m("span"),A=U($),R=x(),O&&O.c(),g=x(),L=m("div"),_=m("span"),_.textContent="Resident:",F=x(),P=m("span"),h=U(C),S=U(" → "),k=U(N),Y=x(),te&&te.c(),v(s,"class","svelte-1itj0d0"),v(c,"class","close-btn svelte-1itj0d0"),v(o,"class","modal-header svelte-1itj0d0"),v(y,"class","label svelte-1itj0d0"),v(d,"class","value svelte-1itj0d0"),v(p,"class","detail-row svelte-1itj0d0"),v(_,"class","label svelte-1itj0d0"),v(P,"class","value svelte-1itj0d0"),v(L,"class","detail-row svelte-1itj0d0"),v(u,"class","profile-details svelte-1itj0d0"),v(n,"class","modal svelte-1itj0d0"),v(e,"class","modal-backdrop svelte-1itj0d0")},m(W,B){H(W,e,B),f(e,n),f(n,o),f(o,s),f(s,r),f(o,i),f(o,c),f(n,a),f(n,u),f(u,p),f(p,y),f(p,b),f(p,d),f(d,A),f(u,R),O&&O.m(u,null),f(u,g),f(u,L),f(L,_),f(L,F),f(L,P),f(P,h),f(P,S),f(P,k),f(u,Y),te&&te.m(u,null),T=!0,w||(J=[re(c,"click",t[13]),re(n,"click",dn(t[16])),re(e,"click",t[13])],w=!0)},p(W,B){(!T||B[0]&4)&&l!==(l=W[2].name+"")&&ne(r,l),(!T||B[0]&4)&&$!==($=W[2].home+"")&&ne(A,$),W[2].work?O?O.p(W,B):(O=on(W),O.c(),O.m(u,g)):O&&(O.d(1),O=null),(!T||B[0]&4)&&C!==(C=W[2].since+"")&&ne(h,C),(!T||B[0]&4)&&N!==(N=W[2].left?`${W[2].left}`:"Now")&&ne(k,N),W[2].history&&W[2].history.length>0?te?te.p(W,B):(te=sn(W),te.c(),te.m(u,null)):te&&(te.d(1),te=null)},i(W){T||(W&&$e(()=>{T&&(E||(E=kt(e,dt,{},!0)),E.run(1))}),T=!0)},o(W){W&&(E||(E=kt(e,dt,{},!1)),E.run(0)),T=!1},d(W){W&&G(e),O&&O.d(),te&&te.d(),W&&E&&E.end(),w=!1,me(J)}}}function on(t){let e,n,o,s,l=t[2].work+"",r;return{c(){e=m("div"),n=m("span"),n.textContent="Work:",o=x(),s=m("span"),r=U(l),v(n,"class","label svelte-1itj0d0"),v(s,"class","value svelte-1itj0d0"),v(e,"class","detail-row svelte-1itj0d0")},m(i,c){H(i,e,c),f(e,n),f(e,o),f(e,s),f(s,r)},p(i,c){c[0]&4&&l!==(l=i[2].work+"")&&ne(r,l)},d(i){i&&G(e)}}}function sn(t){let e,n,o,s,l=ce(t[2].history),r=[];for(let i=0;i<l.length;i+=1)r[i]=ln(Jt(t,l,i));return{c(){e=m("div"),n=m("span"),n.textContent="History",o=x(),s=m("ul");for(let i=0;i<r.length;i+=1)r[i].c();v(n,"class","label svelte-1itj0d0"),v(s,"class","history-list svelte-1itj0d0"),v(e,"class","history-section svelte-1itj0d0")},m(i,c){H(i,e,c),f(e,n),f(e,o),f(e,s);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(s,null)},p(i,c){if(c[0]&4){l=ce(i[2].history);let a;for(a=0;a<l.length;a+=1){const u=Jt(i,l,a);r[a]?r[a].p(u,c):(r[a]=ln(u),r[a].c(),r[a].m(s,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=l.length}},d(i){i&&G(e),Ie(r,i)}}}function Do(t){let e;return{c(){e=U("Left the city")},m(n,o){H(n,e,o)},p:Z,d(n){n&&G(e)}}}function Ro(t){let e;return{c(){e=U("Moved in (correction)")},m(n,o){H(n,e,o)},p:Z,d(n){n&&G(e)}}}function jo(t){let e;return{c(){e=U("Evicted (zone demolished)")},m(n,o){H(n,e,o)},p:Z,d(n){n&&G(e)}}}function Lo(t){let e;return{c(){e=U("Evicted (overcrowding)")},m(n,o){H(n,e,o)},p:Z,d(n){n&&G(e)}}}function xo(t){let e;return{c(){e=U("Lost job (workplace closed)")},m(n,o){H(n,e,o)},p:Z,d(n){n&&G(e)}}}function No(t){let e;return{c(){e=U("Laid off (downsizing)")},m(n,o){H(n,e,o)},p:Z,d(n){n&&G(e)}}}function zo(t){let e;return{c(){e=U("Lost job (fired for absence)")},m(n,o){H(n,e,o)},p:Z,d(n){n&&G(e)}}}function Oo(t){let e,n=t[24].work+"",o;return{c(){e=U("Started job at "),o=U(n)},m(s,l){H(s,e,l),H(s,o,l)},p(s,l){l[0]&4&&n!==(n=s[24].work+"")&&ne(o,n)},d(s){s&&(G(e),G(o))}}}function Po(t){let e,n=t[24].from+"",o,s,l=t[24].to+"",r;return{c(){e=U("Moved "),o=U(n),s=U(" → "),r=U(l)},m(i,c){H(i,e,c),H(i,o,c),H(i,s,c),H(i,r,c)},p(i,c){c[0]&4&&n!==(n=i[24].from+"")&&ne(o,n),c[0]&4&&l!==(l=i[24].to+"")&&ne(r,l)},d(i){i&&(G(e),G(o),G(s),G(r))}}}function qo(t){let e,n=t[24].home+"",o;return{c(){e=U("Moved into "),o=U(n)},m(s,l){H(s,e,l),H(s,o,l)},p(s,l){l[0]&4&&n!==(n=s[24].home+"")&&ne(o,n)},d(s){s&&(G(e),G(o))}}}function ln(t){let e,n,o=t[24].time+"",s,l,r,i;function c(p,y){if(p[24].type==="move_in")return qo;if(p[24].type==="move")return Po;if(p[24].type==="new_job")return Oo;if(p[24].type==="fired")return zo;if(p[24].type==="fired_excess")return No;if(p[24].type==="workplace_demolished")return xo;if(p[24].type==="evicted")return Lo;if(p[24].type==="evicted_bulldoze")return jo;if(p[24].type==="drift_correction_spawn")return Ro;if(p[24].type==="left_city")return Do}let a=c(t),u=a&&a(t);return{c(){e=m("li"),n=m("span"),s=U(o),l=x(),r=m("span"),u&&u.c(),i=x(),v(n,"class","history-time svelte-1itj0d0"),v(r,"class","history-desc"),v(e,"class","svelte-1itj0d0")},m(p,y){H(p,e,y),f(e,n),f(n,s),f(e,l),f(e,r),u&&u.m(r,null),f(e,i)},p(p,y){y[0]&4&&o!==(o=p[24].time+"")&&ne(s,o),a===(a=c(p))&&u?u.p(p,y):(u&&u.d(1),u=a&&a(p),u&&(u.c(),u.m(r,null)))},d(p){p&&G(e),u&&u.d()}}}function Wo(t){let e,n,o,s,l,r,i,c,a,u,p,y,b,d,$,A,R,g,L,_=t[3]&&t[4].length>0&&Qt(t);const F=[Eo,To],P=[];function C(S,N){return S[7]>0?0:1}d=C(t),$=P[d]=F[d](t);let h=t[2]&&nn(t);return{c(){e=m("div"),n=m("h3"),n.textContent="SimTwitty Feed",o=x(),s=m("div"),l=m("textarea"),r=x(),_&&_.c(),i=x(),c=m("div"),a=m("button"),u=U("Twit 'em"),y=x(),b=m("div"),$.c(),A=x(),h&&h.c(),v(n,"class","svelte-1itj0d0"),v(l,"placeholder","What's happening in the city, Mayor?"),v(l,"class","svelte-1itj0d0"),a.disabled=p=!t[1].trim(),v(a,"class","svelte-1itj0d0"),v(c,"class","tweet-actions svelte-1itj0d0"),v(s,"class","tweet-input svelte-1itj0d0"),v(b,"class","messages-container svelte-1itj0d0"),v(e,"class","feed svelte-1itj0d0")},m(S,N){H(S,e,N),f(e,n),f(e,o),f(e,s),f(s,l),t[17](l),Ze(l,t[1]),f(s,r),_&&_.m(s,null),f(s,i),f(s,c),f(c,a),f(a,u),f(e,y),f(e,b),P[d].m(b,null),f(e,A),h&&h.m(e,null),R=!0,g||(L=[re(l,"input",t[18]),re(l,"keydown",t[11]),re(l,"input",t[8]),re(l,"click",t[8]),re(a,"click",t[10])],g=!0)},p(S,N){N[0]&2&&Ze(l,S[1]),S[3]&&S[4].length>0?_?_.p(S,N):(_=Qt(S),_.c(),_.m(s,i)):_&&(_.d(1),_=null),(!R||N[0]&2&&p!==(p=!S[1].trim()))&&(a.disabled=p);let k=d;d=C(S),d===k?P[d].p(S,N):(Pe(),fe(P[k],1,1,()=>{P[k]=null}),qe(),$=P[d],$?$.p(S,N):($=P[d]=F[d](S),$.c()),oe($,1),$.m(b,null)),S[2]?h?(h.p(S,N),N[0]&4&&oe(h,1)):(h=nn(S),h.c(),oe(h,1),h.m(e,null)):h&&(Pe(),fe(h,1,1,()=>{h=null}),qe())},i(S){R||(oe($),oe(h),R=!0)},o(S){fe($),fe(h),R=!1},d(S){S&&G(e),t[17](null),_&&_.d(),P[d].d(),h&&h.d(),g=!1,me(L)}}}function Go(t,e,n){let o,s,l;ge(t,ve,k=>n(22,o=k)),ge(t,gn,k=>n(0,s=k)),ge(t,He,k=>n(7,l=k));let r="",i=null,c=[],a=!1,u="",p=[],y=0,b;function d(k){$(k.target)}function $(k){const Y=k.selectionStart,E=k.value,T=E.lastIndexOf("@",Y-1);if(T!==-1){const w=E.slice(T+1,Y);if(!w.includes(" ")){n(3,a=!0),n(15,u=w),n(5,y=0);return}}n(3,a=!1),n(15,u="")}function A(k){if(!b)return;const Y=b.selectionStart,E=r,T=E.lastIndexOf("@",Y-1);if(T!==-1){const w=E.slice(0,T),J=E.slice(Y);n(1,r=`${w}@${k} ${J}`),n(3,a=!1),n(15,u=""),setTimeout(()=>{b.focus();const O=T+k.length+2;b.setSelectionRange(O,O)},0)}}function R(){if(r.trim()){we(r,{name:"Mayor",isSystem:!0});const k=Vn(r);if(k){const Y=o.find(E=>E.name.toLowerCase()===k.toLowerCase()&&!E.left);Y&&Jn(Y.name,r)}n(1,r="")}}function g(k){if(a&&p.length>0){if(k.key==="ArrowDown"){k.preventDefault(),n(5,y=(y+1)%p.length);return}if(k.key==="ArrowUp"){k.preventDefault(),n(5,y=(y-1+p.length)%p.length);return}if(k.key==="Enter"||k.key==="Tab"){k.preventDefault(),A(p[y]);return}if(k.key==="Escape"){k.preventDefault(),n(3,a=!1);return}}k.key==="Enter"&&!k.shiftKey&&(k.preventDefault(),R())}function L(k){k.isSystem||n(2,i=k)}function _(){n(2,i=null)}function F(k){pn.call(this,t,k)}function P(k){rt[k?"unshift":"push"](()=>{b=k,n(6,b)})}function C(){r=this.value,n(1,r)}const h=k=>A(k),S=k=>n(5,y=k),N=k=>L(k.author);return t.$$.update=()=>{if(t.$$.dirty[0]&1){const k=new Set;s.forEach(Y=>{Y.author&&Y.author.name&&k.add(Y.author.name)}),n(14,c=Array.from(k).sort())}t.$$.dirty[0]&49152&&(u?n(4,p=c.filter(k=>k.toLowerCase().includes(u.toLowerCase())).slice(0,5)):n(4,p=c.slice(0,5)))},[s,r,i,a,p,y,b,l,d,A,R,g,L,_,c,u,F,P,C,h,S,N]}class Uo extends Re{constructor(e){super(),De(this,e,Go,Wo,Ae,{},null,[-1,-1])}}function Ho(t){let e,n,o,s,l,r,i,c,a,u,p,y,b;return n=new fo({}),r=new yo({}),a=new Ao({}),y=new Uo({}),{c(){e=m("div"),Ne(n.$$.fragment),o=x(),s=m("div"),l=m("main"),Ne(r.$$.fragment),i=x(),c=m("div"),Ne(a.$$.fragment),u=x(),p=m("aside"),Ne(y.$$.fragment),v(c,"class","game-board svelte-ui0l6c"),v(l,"class","svelte-ui0l6c"),v(p,"class","svelte-ui0l6c"),v(s,"class","content-wrapper svelte-ui0l6c"),v(e,"class","app-container svelte-ui0l6c")},m(d,$){H(d,e,$),Ce(n,e,null),f(e,o),f(e,s),f(s,l),Ce(r,l,null),f(l,i),f(l,c),Ce(a,c,null),f(s,u),f(s,p),Ce(y,p,null),b=!0},p:Z,i(d){b||(oe(n.$$.fragment,d),oe(r.$$.fragment,d),oe(a.$$.fragment,d),oe(y.$$.fragment,d),b=!0)},o(d){fe(n.$$.fragment,d),fe(r.$$.fragment,d),fe(a.$$.fragment,d),fe(y.$$.fragment,d),b=!1},d(d){d&&G(e),Se(n),Se(r),Se(a),Se(y)}}}function Fo(t){let e;return Cn(()=>{e=setInterval(()=>{Xn()},250)}),Sn(()=>{e&&clearInterval(e)}),[]}class Bo extends Re{constructor(e){super(),De(this,e,Fo,Ho,Ae,{})}}new Bo({target:document.getElementById("app")});
